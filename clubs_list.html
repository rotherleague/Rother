<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheet Club Names and Sections</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
            text-align: left;
        }
        h1, h2, h3 {
            color: #333;
        }
        .section-container {
            margin-top: 20px;
        }
        .club-list {
            margin-bottom: 20px;
        }
        .contact-info {
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <h1>Google Sheet Column Names and Club Sections</h1>
    
    <h2>Column Names</h2>
    <table id="columnNamesTable">
        <thead>
            <tr>
                <th>Column Names</th>
            </tr>
        </thead>
        <tbody>
            <!-- Column names will be inserted here -->
        </tbody>
    </table>
    
    <div class="club-list">
        <h2>List of Clubs</h2>
        <ul id="clubList">
            <!-- List of club names will be inserted here -->
        </ul>
    </div>

    <div class="section-container" id="clubSections">
        <!-- Sections for each club will be inserted here -->
    </div>

    <!-- Load PapaParse library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.0/papaparse.min.js"></script>
    <script>
        // URL of the published Google Sheet in CSV format
        const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR4VY_mJjSYwTf7n1xBWtsqvo3x4RIXErc4fhel4TRyEcAtG78pfsAfrLWTrXXTzigUJvT7nDUDWg0E/pub?output=csv';

        // Fetch the CSV data from the published Google Sheet
        Papa.parse(url, {
            download: true,
            header: true,
            complete: function(results) {
                // Extract the column names from the first row
                const columnNames = Object.keys(results.data[0]);

                // Get the table body element for column names
                const tbody = document.querySelector('#columnNamesTable tbody');
                columnNames.forEach(name => {
                    const tr = document.createElement('tr');
                    const td = document.createElement('td');
                    td.textContent = name;
                    tr.appendChild(td);
                    tbody.appendChild(tr);
                });

                // Extract the 'Name Of Club' column data
                const clubs = results.data.map(row => row['Name Of Club']).filter(name => name); // Filter out any empty values

                // Get the list element for club names
                const clubList = document.querySelector('#clubList');
                clubs.forEach(club => {
                    const li = document.createElement('li');
                    const anchor = document.createElement('a');
                    anchor.href = `#${club.replace(/\s+/g, '_')}`; // Replace spaces with underscores for anchor links
                    anchor.textContent = club;
                    li.appendChild(anchor);
                    clubList.appendChild(li);
                });

                // Get the section container element for club sections
                const sectionContainer = document.querySelector('#clubSections');
                clubs.forEach(club => {
                    const clubData = results.data.find(row => row['Name Of Club'] === club);

                    const section = document.createElement('section');
                    section.id = club.replace(/\s+/g, '_'); // Replace spaces with underscores for section IDs
                    section.innerHTML = `
                        <h2>${club}</h2>
                        <div class="contact-info">
                            <h3>Secretary</h3>
                            <p><strong>First Name:</strong> ${clubData['First Name']}</p>
                            <p><strong>Surname:</strong> ${clubData['Surname']}</p>
                            <p><strong>Email:</strong> <a href="mailto:${clubData['Email']}">${clubData['Email']}</a></p>
                            <p><strong>Phone:</strong> ${clubData['Phone']}</p>
                        </div>
                        <div class="contact-info">
                            <h3>Welfare</h3>
                            <p><strong>First Name:</strong> ${clubData['7th First Name']}</p>
                            <p><strong>Surname:</strong> ${clubData['7th Surname']}</p>
                            <p><strong>Email:</strong> <a href="mailto:${clubData['7th Email']}">${clubData['7th Email']}</a></p>
                            <p><strong>Phone:</strong> ${clubData['7th Phone']}</p>
                        </div>
                    `;
                    sectionContainer.appendChild(section);
                });
            },
            error: function(error) {
                console.error('Error fetching or parsing CSV:', error);
            }
        });
    </script>
</body>
</html>
